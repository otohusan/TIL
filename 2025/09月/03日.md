# 2025年09月03日

## バッチについて
リアルタイム性は求められないが、時間がかかる処理をバッチ処理として実装する

railsでバッチ処理を書く方法はいくつかあって代表的なものが以下
- lib/tasks配下にrakeファイルを作成
- RubyスクリプトをRails Runner経由で実行する
- バックエンドサーバ(Sidekiqなど)に委ねる

<br>

## Sidekiqとは

何らかのタスクを非同期で実行するために活用されている

- 外部API 呼び出し
- 重い DB 集約処理、集計、キャッシュ再計算
- スケジューリング（定期ジョブ）
- Webhook の再試行や再送処理

とかで使用すると良いらしい。

具体的な使い方は、使う日が来たら改めて調べよう

<br>

## each、find_each
### each
オブジェクトのセット全体をメモリに読み込み、それからループ処理を行う

データが多いとメモリを大量に消費してしまう

数千程度であればeachメソッドで問題ないぽい

### find_each
分割してレコードを取得し、その単位ごとにメモリに読み込むので、データが大規模なときはこっち使いたい

注意点としては、PRIMARYによってソートをし、処理を実行するので、実行順に意味のある処理の時は使えない
