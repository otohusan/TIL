# 2025年8月18日

## accepts_nested_attributes_for
親モデルに紐づくレコードの保存を簡単にできるようにする

### 例
```rb
class Author < ActiveRecord::Base
  has_many :books
  accepts_nested_attributes_for :books
end

# フォームから送信するパラメータ
params = { name: {
  name: '礼流図 太郎', books_attributes: [
    { title: 'おいしいジュースのつくりかた' }
  ]
}}

# コントローラ内で行う処理
def create
  Author.create(params_permitted)
end

def params_permitted
  params.require(:author).permit(:name, books_attributes: [:title])
end
```

これだけで、bookのレコードも作成できてる

### 使わない方がいい？
[railsの作者が否定的なコメント](https://github.com/rails/rails/pull/26976#discussion_r87855694)をしてるらしい

具体的にどこが問題なのかは、まだ調べ中

代替案は以下のものとかがあるらしい
- Formオブジェクトを活用する

### 参考
- https://zenn.dev/murakamiiii/articles/5ecefb7a58d1ef
- https://api.rubyonrails.org/v8.0/classes/ActiveRecord/NestedAttributes/ClassMethods.html
